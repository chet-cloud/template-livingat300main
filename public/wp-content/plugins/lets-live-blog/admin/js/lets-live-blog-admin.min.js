/**
 * Copyright: Codetipi
 * Theme: Let's Live Blog
 * Version: 1.0.2
 */
!function(i){"use strict";var t={init:function(){this.cacheDom(),this.bindEvents(),this.colorPicker(),this.dragDrop(),this.required(),this.slider(),this.dates()},cacheDom:function(){this.$doc=i(document),this.$body=i("body"),this.$colorPicker=i(".lets-live-blog-color-pick"),this.$slider=i(".lets-live-blog-slider"),this.$dates=i(".lets-live-blog-date-field").find("input"),this.$sliderReset=i(".lets-live-blog-slider-wrap .lets-live-blog-reset"),this.$sectionShower=i(".lets-live-blog-metabox-wrap .lets-live-blog-trig"),this.$metaboxControls=i(".lets-live-blog-metabox-controls"),this.$upload=i(".lets-live-blog-upload"),this.$galleryUpload=i(".lets-live-blog-gallery"),this.$required=i(".lets-live-blog-req"),this.$dragDrop=i(".lets-live-blog-drag-drop"),this.modal=!1,this.galleryModal=!1,this.debug=!1},dates:function(){0!==this.$dates.length&&this.$dates.datetimepicker({beforeShow:function(t,e){i("#ui-datepicker-div").addClass("lets-live-blog-date-wrap")},showOtherMonths:!0,closeText:letsLiveBlogJS.i18n.close,currentText:letsLiveBlogJS.i18n.now,prevText:'<span class="dashicons dashicons-arrow-left-alt2"></span>',nextText:'<span class="dashicons dashicons-arrow-right-alt2"></span>'})},bindEvents:function(){this.$sliderReset.on("click",this.sliderReset),this.$sectionShower.on("click",this.sectionShower),this.$upload.on("click",this.upload),this.$galleryUpload.on("click",this.galleryUpload),this.$body.on("click",".lets-live-blog-remove",this.uploadRemove),this.$body.on("click",".lets-live-blog-remove-gallery",this.parentRemove),this.$body.on("change",".lets-live-blog-required",this.requiredCheck)},dragDrop:function(){this.$dragDrop.sortable({placeholder:"ui-state-highlight",classes:{"ui-sortable":"lets-live-blog-control-only"}}),this.$dragDrop.disableSelection()},requiredCheck:function(e,s){i(void 0===s?this:s).each(function(){var a=i(this);switch(a.closest(".lets-live-blog-control").data("control")){case"on-off":a.data("dependees").forEach(function(s){!0===a.is(":checked")&&"on"===s.val?t.showIt(i("#"+s.id),e):!1===a.is(":checked")&&"on"===s.val&&t.hideIt(i("#"+s.id),e),!1===a.is(":checked")&&"off"===s.val?t.showIt(i("#"+s.id),e):!0===a.is(":checked")&&"off"===s.val&&t.hideIt(i("#"+s.id),e)});break;case"radio-images":a.data("dependees").forEach(function(l){if(l.val.length>1){for(var o=0,d=l.val.length;o<d;o++)l.val[o]=l.val[o].toString();!0===a.is(":checked")&&-1!=i.inArray(a.val(),l.val)?t.showIt(i("#"+l.id),e):void 0===s&&t.hideIt(i("#"+l.id),e)}else!0===a.is(":checked")&&a.val()==l.val?t.showIt(i("#"+l.id),e):void 0===s&&t.hideIt(i("#"+l.id),e)});break;case"select":a.data("dependees").forEach(function(l){a.val()==l.val?t.showIt(i("#"+l.id),e):void 0===s&&t.hideIt(i("#"+l.id),e)})}})},showIt:function(i,t){void 0===t?i.show():i.slideDown(100)},hideIt:function(i,t){void 0===t?i.hide():i.slideUp(100)},required:function(e){this.$required.each(function(){var t=i(this),e=i(this).data("req-val"),s=t.attr("id"),a=t.data("req"),l=i("#"+a).find(".lets-live-blog-input-val");if(l.addClass("lets-live-blog-required"),void 0===l.data("dependees"))l.data("dependees",[{id:s,val:e}]);else{var o=l.data("dependees");o.push({id:s,val:e}),l.data("dependees",o)}}),t.requiredCheck(e,".lets-live-blog-required")},uploadRemove:function(e){e.preventDefault();var s=i(this);s.closest(".lets-live-blog-meta-control").find(".lets-live-blog-img-input").val("");var a=s.closest(".lets-live-blog-meta-control").find(".lets-live-blog-vis-switch");a.length&&a.addClass("lets-live-blog-hide"),t.parentRemove(e,s)},parentRemove:function(t,e){t.preventDefault(),void 0!==e?e.parent().remove():i(this).parent().remove()},upload:function(e){e.preventDefault();var s=i("#"+i(this).data("dest")),a=i(this).data("output"),l=i(this).data("file-type"),o=s.find(".lets-live-blog-vis-switch");t.modal=wp.media({title:letsLiveBlogJS.i18n.titleModal,button:{text:letsLiveBlogJS.i18n.titleButton},multiple:!1}),t.modal.on("select",function(){var i=t.modal.state().get("selection").first().toJSON();if("img"===l)var e=void 0!==typeof i.sizes.thumbnail?i.sizes.thumbnail.url:i.url;var d="id"===a?i.id:i.url;s.find(".lets-live-blog-img-input").val(d),s.find(".lets-live-blog-img").remove(),"img"===l&&s.find(".lets-live-blog-control-only").append('<span class="lets-live-blog-img"><a href="#" class="lets-live-blog-remove lets-live-blog--x"></a><img src="'+e+'" alt=""></span>'),o.length&&o.removeClass("lets-live-blog-hide")}).open()},galleryUpload:function(e){e.preventDefault();var s=i(this);t.galleryModal=wp.media({title:letsLiveBlogJS.i18n.titleGalleryModal,button:{text:letsLiveBlogJS.i18n.titleButton},multiple:!0}),t.galleryModal.on("select",function(){for(var e=t.galleryModal.state().get("selection").models,a=0;a<e.length;a++){var l=e[a].toJSON(),o=void 0!==typeof l.sizes.thumbnail?l.sizes.thumbnail.url:l.url;i("#"+s.data("dest")).find(".lets-live-blog-gallery-images-wrap").append('<span data-id="'+l.id+'" class="lets-live-blog-img"><a href="#" class="lets-live-blog-remove-gallery lets-live-blog--x"></a><img src="'+o+'" alt=""><input type="hidden" value="'+l.id+'" name="'+s.data("name")+'[]"></span>')}a=0}).open()},sectionShower:function(t){t.preventDefault();var e=i("#"+i(this).data("section"));e.siblings().addClass("lets-live-blog-hide"),e.removeClass("lets-live-blog-hide"),i(this).siblings().removeClass("lets-live-blog-active"),i(this).addClass("lets-live-blog-active")},colorPicker:function(){this.$colorPicker.wpColorPicker()},slider:function(){this.$slider.each(function(){var t=i(this);t.slider({min:t.data("min"),max:t.data("max"),step:t.data("step"),range:"min",value:t.data("value"),slide:function(i,e){t.next().val(e.value),t.next().next().find(".lets-live-blog-val").html(e.value)}})})},sliderReset:function(){var t=i(this).closest(".lets-live-blog-control").find(".lets-live-blog-slider"),e=t.data("default");t.slider({value:e}),t.next().val(e),t.next().next().find(".lets-live-blog-val").html(e)}};t.init()}(jQuery);